<!DOCTYPE html>
   <head>
      <meta charset="UTF-8">
      <title>Главная страница</title>
      <link rel="stylesheet" href="style.css">
      <link href="https://fonts.googleapis.com/css?family=Arimo&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css?family=Roboto+Slab&display=swap" rel="stylesheet">
      <style>
         .valid
         {
            border: 3px solid green;
         }
         .undef
         {
            border: 3px solid grey;
         }


         #authorization
         {
           width: 20%;
           float: left;
           margin-top: 0;
           margin-left: 15px;
           border: 1px solid black;
         }
         #authorization span
         {
            margin-left: 2%;
            display:  inline-block;
            width: 10%;
         }
         #authorization input
         {
            display: inline-block;
            margin-left: 15%;
            width: 50%;
         }
         #authorization input[type="button"]
         {
            margin-left: 5%;
         }


         #notice
         {
            margin-left: 15px;
            margin-top: 10px;
            clear: both;
            border: 1px solid black;
            width: 20%;
            overflow: hidden;
            float: left;
            display: none;
         }
         #results
         {
            margin-left: 23%;
            margin-top: 0;
            width: 75%;
            border: 1px solid black;
            overflow: hidden;
         }
         #toComeIn
         {
            margin-left: 5%;
         }
         #join
         {
            margin-left: 7%;
         }

         #noticeTitle, #authorizationTitle
         {
            color: white;
            text-align: center;
            margin: 0;
            background-color: rgb(39, 170, 226);
         }

         #search
         {
            margin-left: 0;
         }
         #searchPlace
         {
            margin: 5px;
            height: 20px;
            width: 20%;
         }
         #search button
         {
            height: 28px;
            width: 80px;
         }

         #registration
         {
            z-index: 150;
            display: none;

            width: 30%;
            height: 50%;
            position: absolute;
            left: 35%;
            top: 30%;
            border: 1px solid black;
            padding: 0;
            border-radius: 20px;
            background-color: rgb(39, 170, 226);
         }
         #registration p
         {
            font-size: 1.5em;
            color: white;
            text-align: center;
         }
         #closeCross
         {
            cursor: pointer;
            margin-left: 94%;
            margin-top: 0;
         }
         #registration input
         {
            width: 70%;
            margin-left: 10px;
            margin-right: 10px;
            margin-top: 15px;
            margin-bottom: 15px;
            height: 100%;
            position: relative;
            z-index: 170;
         }
         #registration table td
         {
            background-color: rgb(39, 170, 226);
            border: none;
         }

         #blackout
         {
            background-color: rgba(1, 1, 1, 0.75);
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;

            z-index: 100;
            display: none;
         }

         .warnings
         {
            color: white;
            background-color: rgb(224, 45, 45);
            display: inline-block;
            height: 40px;
            width: 316px;
            position: absolute;
            margin-left: -320px;
            margin-top: 1px;
            font-size: 11px;
            padding: 0;
            z-index: 160;
         }
         #warning1, #warning2, #warning3, #warning4
         {
            display: none;
         }




      </style>



      <script>
         // Функция показа
         function show(state) {
            document.getElementById("registration").style.display = state;
            document.getElementById("blackout").style.display = state;
            document.getElementById("userSurname").focus();
         }
      </script>

      
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

   </head>
   <body>
      <header>
         <p><a href="main.html"><img src="book.png" width="70px"></a>Новосибирский книжный каталог</p>
      </header>

      <!--Шапка сайта-->
      <table id="siteHead">
         <tr>
            <td id="col1" title="Перейти на главную страницу"><a href="main.html">Главная</a></li></td>
            <td id="userMenu">
               <p>Личный кабинет</p>
                  <ul> 
                     <li title="Посмотреть список забронированных книг"><a href="resrvation.html">Список бронирований</a></li>
                     <li title="Добавить новую книгу в каталог"><a href="adding_book.html">Добавление новой книги</a></li>
                  </ul>
               </div>
            </td>
            <td id="col3" title="Поиск по нескольким полям"><a href="advanced_search.html">Расширенный поиск</a></td>
            <td id="col4">

            </td>
         </tr>
         <tr id="secondRaw">
            <!--Поисковик-->
            <td colspan="4">
               <form id="search">
                  <input type="text" placeholder="Поиск" id="searchPlace" required
                     autofocus>
                  <button type="submit" title="Начать поиск">Поиск</button>
               </form>
            </td>
         </tr>
      </table>

      
      
      <!--Форма для авторизации-->
      <form id="authorization"> 
         <p id="authorizationTitle">Вход в систему</p>
         <p title="укажите свой логин"><span>Логин:</span> <input type="text"></p>
         <p title="укажите пароль от профиля"><span>Пароль:</span> <input type="password"></p>
         <p><button id="toComeIn">Войти</button> <input id="join" type="button" onclick="show('block')" value="Зарегистрироваться" title="пройти регистрацию"></p>
      </form>



         


         
      <!--Уведомления-->
      <div id="notice">
         <p id="noticeTitle">Уведомления</p>
         <p>Уведомление 1</p>
         <p>Уведомление 2</p>
         <p>Уведомление 3</p>
      </div>



      <!--Результаты поиска-->
      <div id="results">
         Тут результаты поиска
      </div>


      <!--Затемнение-->
      <div id="blackout"></div>


      <!--Регистарция-->
      <form id="registration" class="form js-validate">
         <img src="cross.png" title="закрыть" alt="закрыть" width="20px" id="closeCross" onclick="show('none')">
         <p>Информация для регистрации</p>
         <table>
            <tr>
               <td><input data-rule="data" type="text" placeholder="Фамилия" id="userSurname" class="undef"><span class="warnings" id="warning1">Неверный формат: вводите только буквы</span></td>
            </tr>
            <tr>
               <td><input data-rule="data" type="text" placeholder="Имя" id="userName" class="undef"><span class="warnings" id="warning2">Неверный формат: вводите только буквы</span></td>
            </tr>
            <tr>
               <td><input data-rule="email" type="text" placeholder="Электронная почта" id="userMail" class="undef" ><span class="warnings" id="warning3">Неверный формат: вводите адрес электронной почты</span></td>
            </tr>
            <tr>
               <td><input data-rule="pass" type="password" placeholder="Пароль" id="userPass" class="undef"><span class="warnings" id="warning4">Поле обязательно для заполнения</span></td>
            </tr>
            <tr>
               <td><button id="regButton" title="Подтвердить регистрацию" disabled>Регистарция</button></td>
            </tr>
         </table>
      </form>
               



   <script>
       // перебираем все поля формы регистрации
      
      let inputs = document.querySelectorAll('input[data-rule]');
         
      for (let input of inputs) {
            input.addEventListener('blur', function () {
               let rule = this.dataset.rule;
               let value = this.value; // содержимое инпута
               let check;

               var dataPattern = new RegExp("[A-Za-zА-Яа-яёЁ]+$");
               var reg = /^([a-za-z0-9_\-\.])+\@([a-za-z0-9_\-\.])+\.([a-za-z]{2,4})$/;

               switch(rule) // обработка зависит от типа инпута
               {
                  case "data": 
                     check = dataPattern.test(value);
                     break;
                  case "email":
                     check = reg.test(value);
                     break;
                  case "pass":
                     check = (value != "");
                     break;
               }
               
               this.classList.remove("valid");


               var thisId = this.id;
               if(check)
               {
                  this.className = "valid";
                  switch(thisId)
                  {
                     case "userSurname":
                        document.getElementById("warning1").style.display = "none";
                        break;
                     case "userName":
                        document.getElementById("warning2").style.display = "none";
                        break;
                     case "userMail":
                        document.getElementById("warning3").style.display = "none";
                        break;
                     case "userPass":
                        document.getElementById("warning4").style.display = "none";
                        break;
                  }
               }
               else
               {
                  this.classList.remove("undef");
                  switch (thisId) {
                     case "userSurname":
                        document.getElementById("warning1").style.display = "inline-block";
                        break;
                     case "userName":
                        document.getElementById("warning2").style.display = "inline-block";
                        break;
                     case "userMail":
                        document.getElementById("warning3").style.display = "inline-block";
                        break;
                     case "userPass":
                        document.getElementById("warning4").style.display = "inline-block";
                        break;
                  }
               }
               checkForms();

            });
         }

         function checkForms()
         {
            var surname = $('#userSurname');
            var name = $('#userName');
            var mail = $('#userMail');
            var pass = $('#userPass');

            if (surname.attr('class') == "valid" && name.attr('class') == "valid" && mail.attr('class') == "valid" && pass.attr('class') == "valid")
               $('#regButton').removeAttr('disabled');
            else
               $('#regButton').attr('disabled', 'disabled');
         }
   </script>
      




   </body>
</html>